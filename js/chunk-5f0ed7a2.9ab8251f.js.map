{"version":3,"sources":["webpack:///./src/components/AlertIndicator.vue?38b4","webpack:///./src/components/AlertIndicator.vue","webpack:///src/components/AlertIndicator.vue","webpack:///./src/components/AlertIndicator.vue?944f","webpack:///./src/components/AlertIndicator.vue?c8cd"],"names":["render","_vm","this","_c","_self","staticClass","on","$event","selectAsi","style","severityColor","maxSeverity","_v","_s","title","isDark","counts","attrs","_l","$config","indicators","severity","key","_e","staticRenderFns","props","type","String","default","query","Array","Object","data","openCounts","timer","computed","$store","getters","getPreference","refresh","state","refreshInterval","getConfig","watch","val","getMostSevere","getCounts","created","cancelTimer","refreshCounts","beforeDestroy","methods","setSearch","URLSearchParams","setFilter","refreshList","dispatch","filter","environment","get","text","status","has","getAll","customer","service","group","_this","AlertsApi","then","response","severityCounts","_this2","paramsWithOpenStatus","append","alarm_model","defaults","normal_severity","_step","_iterator","_createForOfIteratorHelper","s","n","done","sev","value","err","e","f","_this3","setTimeout","_this4","clearTimeout","component","VCard","VCardActions","VCardText","VFlex","VLayout"],"mappings":"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","file":"js/chunk-5f0ed7a2.9ab8251f.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertIndicator.vue?vue&type=style&index=0&id=2fffb3c6&prod&scoped=true&lang=css&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{staticClass:\"alert-indicator\",on:{\"click\":function($event){return _vm.selectAsi()}}},[_c('v-card-text',{staticClass:\"pa-0\",style:({ 'background-color': _vm.severityColor(_vm.maxSeverity) })},[_c('div',{staticClass:\"text-uppercase text-xs-center py-2\"},[_vm._v(\" \"+_vm._s(_vm.title)+\" \")])]),_c('v-card-actions',{staticClass:\"pa-0 mx-0\",style:({ 'background-color': _vm.isDark ? '' : '#F5F5F5' })},[_c('v-layout',[_c('v-flex',[_c('div',{staticClass:\"counts-container\"},[(_vm.counts)?_c('v-layout',{attrs:{\"align-start\":\"\",\"justify-space-between\":\"\"}},_vm._l((_vm.$config.indicators.severity),function(severity){return _c('div',{key:severity,staticClass:\"count text-xs-center py-2\",style:({ 'background-color': _vm.severityColor(severity) })},[_vm._v(\" \"+_vm._s(_vm.counts[severity] || 0)+\" \")])}),0):_vm._e()],1)])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card\n    class=\"alert-indicator\"\n    @click=\"selectAsi()\"\n  >\n    <v-card-text\n      class=\"pa-0\"\n      :style=\"{ 'background-color': severityColor(maxSeverity) }\"\n    >\n      <div\n        class=\"text-uppercase text-xs-center py-2\"\n      >\n        {{ title }}\n      </div>\n    </v-card-text>\n\n    <v-card-actions\n      class=\"pa-0 mx-0\"\n      :style=\"{ 'background-color': isDark ? '' : '#F5F5F5' }\"\n    >\n      <v-layout>\n        <v-flex>\n          <div\n            class=\"counts-container\"\n          >\n            <v-layout\n              v-if=\"counts\"\n              align-start\n              justify-space-between\n            >\n              <div\n                v-for=\"severity in $config.indicators.severity\"\n                :key=\"severity\"\n                class=\"count text-xs-center py-2\"\n                :style=\"{ 'background-color': severityColor(severity) }\"\n              >\n                {{ counts[severity] || 0 }}\n              </div>\n            </v-layout>\n          </div>\n        </v-flex>\n      </v-layout>\n    </v-card-actions>\n  </v-card>\n</template>\n\n<script>\nimport AlertsApi from '../services/api/alert.service'\n\nexport default {\n  props: {\n    title: {\n      type: String,\n      default: ''\n    },\n    query: {\n      type: [ String, Array, Object ],  // URLSearchParams\n      default: ''\n    }\n  },\n  data: () => ({\n    counts: null,\n    openCounts: null,\n    maxSeverity: null,\n    timer: null\n  }),\n  computed: {\n    isDark() {\n      return this.$store.getters.getPreference('isDark')\n    },\n    refresh() {\n      return this.$store.state.refresh\n    },\n    refreshInterval() {\n      return (\n        this.$store.getters.getPreference('refreshInterval') ||\n        this.$store.getters.getConfig('refresh_interval')\n      )\n    }\n  },\n  watch: {\n    refresh(val) {\n      if (val) {\n        this.getMostSevere()\n        this.getCounts()\n      }\n    }\n  },\n  created() {\n    this.cancelTimer()\n    this.refreshCounts()\n  },\n  beforeDestroy() {\n    this.cancelTimer()\n  },\n  methods: {\n    selectAsi() {\n      this.setSearch(new URLSearchParams(this.query))\n      this.setFilter(new URLSearchParams(this.query))\n      this.refreshList()\n    },\n    setSearch(query) {\n      this.$store.dispatch('alerts/updateQuery', query)\n    },\n    setFilter(filter) {\n      this.$store.dispatch('alerts/setFilter', {\n        environment: filter.get('environment'),\n        text: filter.get('text'),\n        status: filter.has('status') ? filter.getAll('status') : null,\n        customer: filter.has('customer') ? filter.getAll('customer') : null,\n        service: filter.has('service') ? filter.getAll('service') : null,\n        group: filter.has('group') ? filter.getAll('group') : null\n      })\n    },\n    severityColor(severity) {\n      return this.counts && this.counts[severity] > 0 ? this.$store.getters.getConfig('colors').severity[severity] : 'transparent'\n    },\n    getCounts() {\n      return AlertsApi.getCounts(new URLSearchParams(this.query))\n        .then(response => (this.counts = response.severityCounts))\n    },\n    getMostSevere() {\n      let paramsWithOpenStatus = new URLSearchParams(this.query)\n      paramsWithOpenStatus.append('status', 'open')\n\n      AlertsApi.getCounts(paramsWithOpenStatus)\n        .then(response => {\n          this.maxSeverity = this.$config.alarm_model.defaults.normal_severity\n          for (let sev of this.$config.indicators.severity) {\n            if (response.severityCounts[sev] > 0) {\n              this.maxSeverity = sev\n              break\n            }\n          }\n        })\n    },\n    refreshCounts() {\n      this.getMostSevere()\n      this.getCounts()\n        .then(() => this.timer = setTimeout(() => this.refreshCounts(), this.refreshInterval))\n    },\n    refreshList() {\n      this.$store.dispatch('set', ['refresh', true])\n      setTimeout(() => {\n        this.$store.dispatch('set', ['refresh', false])\n      }, 300)\n    },\n    cancelTimer() {\n      if (this.timer) {\n        clearTimeout(this.timer)\n        this.timer = null\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.alert-indicator .v-card__text div {\n  height: 34px;\n  font-weight: bold;\n  font-family: 'Sintony', sans-serif;\n  font-size: 14px;\n  vertical-align: middle;\n}\n.alert-indicator .v-card__actions div {\n  height: 34px;\n  font-family: 'Sintony', sans-serif;\n  font-size: 14px;\n  vertical-align: middle;\n}\n\n.count {\n  min-width: 16%;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertIndicator.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertIndicator.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlertIndicator.vue?vue&type=template&id=2fffb3c6&scoped=true&\"\nimport script from \"./AlertIndicator.vue?vue&type=script&lang=js&\"\nexport * from \"./AlertIndicator.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AlertIndicator.vue?vue&type=style&index=0&id=2fffb3c6&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2fffb3c6\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VFlex } from 'vuetify/lib/components/VGrid';\nimport { VLayout } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCard,VCardActions,VCardText,VFlex,VLayout})\n"],"sourceRoot":""}